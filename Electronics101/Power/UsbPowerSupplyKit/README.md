# #340 USB Power Supply Kit

Building a USB Wall Wart and taking a look at how they work .. instead of taking them apart or having them blow up.

![Build](./assets/UsbPowerSupplyKit_build.jpg?raw=true)

## Notes

I've taken apart and had enough "wall wart" power supplies blow up on me .. so perhaps it is about time to put one together instead!

Love them or hate them, "wall warts" represent amazing innovation upon which ubiquitous low voltage regulated power is built.
I found an irresistable deal on [a kit version of a standard power supply](https://www.aliexpress.com/item/Power-Plug-DIY-Kit-5V-800mA-Regulated-Power-Supply-AC-DC-220V-to-5V-Power-Converter/32582894778.html), so time to take a peek inside a "common design".

## Parts

![kit_parts](./assets/kit_parts.jpg?raw=true)

| Part | Description |
|------|-------------|
| R1   | 1Ω          |
| R2   | 10kΩ        |
| R3   | 15Ω         |
| R4   | 100kΩ       |
| R5   | 27kΩ        |
| R6   | 1kΩ         |
| R7   | 2.2MΩ       |
| R8   | 1Ω          |
| R9   | 560Ω        |
| R10  | 100Ω        |
| R11  | 9.1kΩ       |
| R12  | 10kΩ        |
| R13  | 1kΩ         |
| C1   | 2.2µF       |
| C2   | 103, 10nF   |
| C3   | 682, 6.8nF  |
| C4   | 104, 100nF  |
| C5   | 222, 2.2nF  |
| C6   | 104, 100nF  |
| C7   | 470µF       |
| D1   | 1N4007      |
| D2   | 1N4007      |
| D3   | 1N4148      |
| D5   | 1N5819      |
| Q1   | MJE13003    |
| Q2   | S9013       |
| U1   | PC817       |
| U2   | TL431       |
| LED  | red 3mm     |
| T1   | trifilar transformer    |
| USB  | female USB  socket |

The single-sided PCB is well designed with decent separation between high and low voltage sides.
It also has a detailed silk-screen, which is just as well, as the schematics I've found online for the circuit appear to be incorrect.

![kit_pcb_front](./assets/kit_pcb_front.jpg?raw=true)

![kit_pcb_rear](./assets/kit_pcb_rear.jpg?raw=true)

## Construction

The [schematic available from sellers](./assets/kit_schematic.jpg?raw=true) doesn't appear to be correct - it does not match the PCB in a coupled of important ways.

Here is my transcription of the schematic .. available [here in EasyEDA](https://easyeda.com/tardate/UsbPowerSupplyKit-d87d4b02fdde4ab88ade1a808439dc22)).
I've verified this matches the PCB..

![Schematic](./assets/UsbPowerSupplyKit_schematic.png?raw=true)

## How it Works

The kit specifies: AC 220V to DC 5V 800mA.
This circuit is similar and typical to a whole variety of switching power supplies.

Breakdown of the circuit:

* D2, C1, R1 comprise a half-wave recitfier turning 220V AC into 300V DC unstable
* R1 cater to the insurance function .. ??
* start-up resistor R7 for the switch Q1 start current
* D1, C3, R4 composite to switch collector peak voltage absorption circuit
* switching transformer T1 primary winding 1-2, feedback winding 4-5, the positive feedback network R6, C2 and switches compose to a self-oscillating circuit
* Q2 is shunt, pulse width modulation and variety of its protection through the switch base current shunt to achieve;
* R2, R3 composition overcurrent protection circuit;
* D3, C4 composite to rectifier filter circuit, power supply for the optocoupler;
* C5 of the pulse width modulated signal from the smoothing effect, eliminate the shunt shunt in advance;
* the secondary winding of the transformer switch 6-10 induced voltage generated through the freewheeling rectifier tube D5, C7 filter output DC;
* R13 and composition of output LED power indicator circuit;
* R11,12 composition sampling circuit;
* a reference voltage generated by the TL431;
* error signal after isolation optocoupler U1 transmitted to the pulse width modulation circuit accurate control of the switch, thereby stabilizing the output DC voltage.

## Build and Test

It's some enjoyable Sunday afternoon soldering therapy. Throw on your favourite music and while away an hour or two...

![UsbPowerSupplyKit_assembly1](./assets/UsbPowerSupplyKit_assembly1.jpg?raw=true)

![UsbPowerSupplyKit_assembly2](./assets/UsbPowerSupplyKit_assembly2.jpg?raw=true)

![UsbPowerSupplyKit_finished_assembly](./assets/UsbPowerSupplyKit_finished_assembly.jpg?raw=true)

![UsbPowerSupplyKit_test](./assets/UsbPowerSupplyKit_test.jpg?raw=true)

## Credits and References

* [5V 800mA Switching Regulated Power Supply Module DIY Kit AC-DC 220V to 5V Power Converter Electronic Circuit Kit Plug DIY Kit](https://www.aliexpress.com/item/Power-Plug-DIY-Kit-5V-800mA-Regulated-Power-Supply-AC-DC-220V-to-5V-Power-Converter/32582894778.html) - aliexpress seller site
* [MJE13003 datasheet](https://www.futurlec.com/Transistors/MJE13003.shtml) - NPN Silicon Power Transistor
* [TL431 datasheet](https://www.futurlec.com/Linear/TL431CLP.shtml) - Programmable Precision Reference
* [PC817 datasheet](https://www.futurlec.com/LED/PC817.shtml) - High Density Opto-Coupler
* [1N4007 Datasheet](https://www.futurlec.com/Diodes/1N4007.shtml)
* [1N4148 Datasheet](https://www.futurlec.com/Diodes/1N4148.shtml)
* [1N5819 Datasheet](https://www.futurlec.com/Diodes/1N5819.shtml)
* [S9013 Datasheet](https://www.futurlec.com/Transistors/S9013.shtml)
* [Schematic for this project in EasyEDA](https://easyeda.com/tardate/UsbPowerSupplyKit-d87d4b02fdde4ab88ade1a808439dc22)
* [..as mentioned on my blog](https://blog.tardate.com/2017/09/leap341-usb-power-supply.html)
