<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RFID Concentration Game: RFID Concentration Game</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RFID Concentration Game
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">RFID Concentration <a class="el" href="class_game.html">Game</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Play a game of Concentration/Pairs with a stack of MIFARE Classic cards.</p>
<div class="image">
<img src="./assets/Concentration_build.jpg?raw=true" alt="Build"/>
</div>
<p>Here's a quick demo..</p>
<p><a href="https://www.youtube.com/watch?v=video_id"></a></p>
<h2>Notes</h2>
<p>You may have played <a href="https://en.wikipedia.org/wiki/Concentration_(card_game)">Concentration</a> - the simple card game where the objective is to pickup as many matching pairs of cards as possible.</p>
<p>I have a stack of RFID cards that I got with a reader, so attempting a version of Concentration was the first and most obvious thing that popped into my head!</p>
<h2>Gameplay Design</h2>
<p>I decided to keep the interaction as simple as possible, and in particular avoid the need for a text display unit, so I designed the game-play around:</p>
<ul>
<li>an 8x8 matrix to display the card identity and flash various effects</li>
<li>a buzzer and LEDs for feedback</li>
<li>and the cards themselves for all input</li>
</ul>
<p>Feedback states:</p>
<table class="doxtable">
<tr>
<th>Name </th><th>Buzzer </th><th>Red </th><th>Green </th><th>Yellow </th><th>Meaning..  </th></tr>
<tr>
<td>gameRunning </td><td>off </td><td>off </td><td>off </td><td>Fast Flash </td><td>in game mode, waiting for a card.. </td></tr>
<tr>
<td>initializing </td><td>off </td><td>Flashing </td><td>Flashing </td><td>Flashing </td><td>in card initialisation mode </td></tr>
<tr>
<td>CardInitialized </td><td>Beep </td><td>off </td><td>ON </td><td>Flashing </td><td>card initialized, ready for a new one </td></tr>
<tr>
<td>CardInitializeFail </td><td>Beep </td><td>ON </td><td>off </td><td>Flash ON </td><td>card initialize failed </td></tr>
<tr>
<td>cardAccepted </td><td>Beep </td><td>off </td><td>Flashing </td><td>off </td><td>first card accepted, present another.. </td></tr>
<tr>
<td>cardMatch </td><td>Happy Beep </td><td>off </td><td>ON </td><td>off </td><td>second card match. Win! </td></tr>
<tr>
<td>cardMismatch </td><td>Sad beep </td><td>Flash ON </td><td>off </td><td>off </td><td>second card mis-match. Fail! </td></tr>
</table>
<h3>Setup</h3>
<p>The RFID cards need to be initialized before they can be used.</p>
<p>After power-on:</p>
<ul>
<li>if a recognised card is scanned, we assume you're starting a game using the card set retrieved from EEPROM.</li>
<li>if an unrecognised card is scanned, we assume you're setting up a new stack of cards:<ul>
<li>the card set is initialised</li>
<li>the card is added to a new card set in memory (grouped into pairs), and the card ID is written back to the card</li>
<li>positive feedback (a "good" beep and green LED)</li>
<li>keeps initialising any other cards that are presented until max card limit reached, or an already-initialised card is presented (which triggers game mode)</li>
</ul>
</li>
</ul>
<h3><a class="el" href="class_game.html">Game</a> Mode</h3>
<ul>
<li>after first card is presented, provides a neutral beep and red/green LEDs flash</li>
<li>when a second card is presented:<ul>
<li>if it matches, plays a happy tune and green LED is on</li>
<li>if it does not match, plays a sad tune and red LED is on</li>
</ul>
</li>
<li>game is over when all pairs have been successfully matched</li>
</ul>
<p>Note:</p>
<ul>
<li>it won't bother to warn on repeated presentations of the same pairs - assume players are policing the rules themselves!</li>
<li>there's no score-keeping, that's up to players, as it doesn't know who or how many players are in the game</li>
</ul>
<h2>Card Data</h2>
<p>For simplicity, uses value blocks for a game ID and card ID.</p>
<p>Data is stored in sector 1. That is, block 4 to block 7:</p>
<ul>
<li>block 4: the game ID value block</li>
<li>block 5: the card ID value block</li>
<li>block 6: unused</li>
<li>block 7: sector trailer</li>
</ul>
<p>Each card is given a sequential number starting from 1. Pairs are the adjacent cards i.e. 1+2, 3+4 etc. That's not random, as it assumes the players will use the age old technique of shuffling the cards before starting the game.</p>
<h2>Circuit Design and Breadboard Prototype</h2>
<p>Power: the MFRC522 is 3.3V device, and officially tolerant up to around 4V. So, running it with the 5V Uno is not strictly legit. Power is supplied correctly at 3.3V, but data lines will stray up to 5V. I haven't included level shifters. But it does seem to work, as many have proven before, though I wouldn't do it this way for anything requiring long term reliability.</p>
<div class="image">
<img src="./assets/Concentration_bb.jpg?raw=true" alt="Concentration_bb"/>
</div>
<div class="image">
<img src="./assets/Concentration_schematic.jpg?raw=true" alt="Concentration_schematic"/>
</div>
<div class="image">
<img src="./assets/Concentration_bb_test.jpg?raw=true" alt="Concentration_bb_test"/>
</div>
<h2>Final Build</h2>
<p>Some decisions for the final build:</p>
<ul>
<li>I replaced the 3 LEDs with the <a href="../../../BoldportClub/cordwood">LEAP#269 Boldport Cordwood</a> for the final build (because it's purdy).</li>
<li>stuck with an Arduino Uno as the base board (as it has the 3.3V and 5V supply already taken care of)</li>
<li>still left out the level shifters for the MFRC522 data lines. So far, so good (fingers crossed)</li>
</ul>
<h2>Credits and References</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Concentration_(card_game)">Concentration</a> - the card game</li>
<li><a href="https://www.arduino.cc/reference/en/language/functions/advanced-io/tone/">tone function</a> - Standard library</li>
<li><a href="../../../BoldportClub/cordwood">LEAP#269 Boldport Cordwood</a> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
